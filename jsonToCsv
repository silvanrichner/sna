import json
import csv

data = json.load(open('data_final.json'))


with open('data.csv', 'w', newline='') as csvfile:
    fieldnames = ['name', 'twittername', 'partei', 'reach']
    writer = csv.DictWriter(csvfile, fieldnames=fieldnames)

    writer.writeheader()

    for party in data['parteien']:
        for politician in data['parteien'][party]:
            writer.writerow({'name': politician, 'twittername': data['parteien'][party][politician]['twittername'], 'partei': party, 'reach': data['parteien'][party][politician]['reach']})